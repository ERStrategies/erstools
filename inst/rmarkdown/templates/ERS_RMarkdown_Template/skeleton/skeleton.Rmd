---
title: "RMarkdown Template"
author: "Zach Friedman"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 3   # Customize the depth of the table of contents for HTML document
    toc_float:
      collapsed: true    # Start with the table of contents expanded
      smooth_scroll: true  # Enable smooth scrolling
knit: (function(inputFile, encoding) {
  rmarkdown::render(inputFile, encoding = encoding,
  output_dir = "knitted files", output_format = "all") })
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Part 0: Read Libraries and connect to Sharepoint

```{r}
ers_load_packages()
options(scipen = 99) #prevent any numbers from showing up as scientific notation
```

```{r}
#set sharepoint site URL for access to our org-wide files
orgfiles_site_url <- "https://erstrategies1.sharepoint.com/sites/orgfiles"
#access sharepoint site URL you may be prompted to sign in here
orgfiles_site <- get_sharepoint_site(site_url = orgfiles_site_url)
```

## 1.1 Set your folder path(s) and read in your data


```{r}
raw_data_folder_path <- "https://erstrategies1.sharepoint.com/sites/orgfiles/Client%20Work/District%20Partners/Columbus%20City/22-23%20Financial%20Equity%20&%20Funding%20System%20Design/1.%20Data%20&%20Analysis%20-%20Secure/Raw%20Data%20for%20R"

raw_data <- ers_read_sharepoint(folder_path = raw_data_folder_path,
                   file_name_with_extension = "XXX.XXX")
```

# Part 2: Validate Data

```{r}
ers_column_info(raw_data)
```


# Part X: Upload File to Sharepoint

```{r}
processed_data_folder_path <- "https://erstrategies1.sharepoint.com/sites/orgfiles/Client%20Work/District%20Partners/Columbus%20City/22-23%20Financial%20Equity%20&%20Funding%20System%20Design/1.%20Data%20&%20Analysis%20-%20Secure/Processed%20Data%20for%20R"

ers_write_sharepoint(data = XXX,
                     folder_path = processed_data_folder_path,
                     file_name_with_extension = "XXX.csv")
```
